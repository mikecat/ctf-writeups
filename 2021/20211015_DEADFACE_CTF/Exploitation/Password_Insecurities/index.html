<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Password Insecurities (DEADFACE CTF) Writeup</title>
<script src="../../../../common/common.js"></script>
</head>
<body>
<language-selector data-langlist="日本語,ja,English,en"></language-selector>
<h1>Password Insecurities</h1>
<span class="language-selector-ja">
<p>
<a href="../../SQL/Body_Count/" class="language-aware-link">Body Count</a> で用いたファイルについて、
顧客 Haily Poutress のパスワードを要求された。
</p><p>
<code>Haily Poutress</code> で検索すると、見つからなかった。<br>
<code>Haily</code> で検索すると、<code>552,'Belcham','Haily',</code> のような構造のデータが複数見つかった。<br>
<code>'Poutress','Haily'</code> で検索すると、以下の1件のデータが見つかった。
</p>
</span>
<span class="language-selector-en">
<p>
Regarding the file used in <a href="../../SQL/Body_Count/" class="language-aware-link">Body Count</a>,
the password for the customer Haily Poutress was asked.
</p><p>
I searched for <code>Haily Poutress</code>, getting no results.<br>
Then, I searched for <code>Haily</code>, finding multiple entries like <code>552,'Belcham','Haily',</code>.<br>
After that, I searched for <code>'Poutress','Haily'</code>, finding this single entry:
</p>
</span>
<code-block data-extension="txt">
(7117,'Poutress','Haily','hpoutress5ho@booking.com','15212 Westport Hill','Ocala','FL','US','34479','M','03/12/1995')
</code-block>

<p class="language-selector-ja">
さらに、<code>cust_passwd</code> から <code>cust_id</code> が <code>7117</code> のものを探すと、以下が見つかった。
</p>
<p class="language-selector-en">
Seeing this, I searched for an entry whose <code>cust_id</code> is <code>7117</code> from <code>cust_passwd</code>, finding this:
</p>
<code-block data-extension="txt">
(7117,7117,'$1$FigUPHDJ$IYWZKYxoKDdLyODRM.kQq.')
</code-block>

<p class="language-selector-ja">
これを <common-tool data-lang="ja">hashcat</common-tool> と <common-tool data-lang="ja">rockyou.txt</common-tool> でクラックすることにした。<br>
まず、以下のページから <code>$1$</code> を検索することで、Hash Mode は 500 であることがわかった。
</p>
<p class="language-selector-en">
I decided to crack this using <common-tool data-lang="en">hashcat</common-tool> and <common-tool data-lang="en">rockyou.txt</common-tool>.<br>
Firstly, I searched for <code>$1$</code> from this page, finding the Hash Mode is 500.
</p>
<p><a href="https://hashcat.net/wiki/doku.php?id=example_hashes">example_hashes [hashcat wiki]</a></p>

<p class="language-selector-ja">
これを踏まえ、以下のコマンドでクラックを実行した。<br>
<code>-a 0</code> は攻撃モード （辞書攻撃) の指定、<code>-w 4</code> は負荷の指定である。
</p>
<p class="language-selector-en">
Then, I executed cracking using this command.<br>
<code>-a 0</code> is specifying the attack mode (to perform a dictionary attack) and <code>-w 4</code> is specifying the load.
</p>
<code-block data-extension="txt">
hashcat -m 500 -a 0 -w 4 D:\...\hash.txt D:\...\rockyou.txt
</code-block>

<p class="language-selector-ja">
その結果、パスワードは <code>trustno1</code> だとわかり、これを用いてflagが得られた。
</p>
<p class="language-selector-en">
This revealed that the password is <code>trustno1</code> and I obtained the flag from this.
</p>

<div class="flag">flag{trustno1}</div>
<hr>
<writeup-by></writeup-by>
<p>
<a href="../../" class="language-aware-link">DEADFACE CTF</a>
</p>
</body>
</html>
