<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>The Root of All Evil... OR... Adding Insult to Injury (DEADFACE CTF) Writeup</title>
<script src="../../../../common/common.js"></script>
</head>
<body>
<language-selector data-langlist="日本語,ja,English,en"></language-selector>
<h1>The Root of All Evil... OR... Adding Insult to Injury</h1>
<span class="language-selector-ja">
<p>
ホスト名とユーザ名が与えられ、接続する方法を要求された。
</p><p>
<a href="../../Traffic_Analysis/Monstrum_ex_Machina/" class="language-aware-link">Monstrum ex Machina</a> で用いたファイル <code>pcap-challenge-final.pcapng</code> に <code>strings</code> コマンドをかけた結果の最後の方には、<br>
<code>-----BEGIN OPENSSH PRIVATE KEY-----</code> と <code>-----END OPENSSH PRIVATE KEY-----</code> で囲まれた部分があった。<br>
そこで、これを秘密鍵として<common-tool data-lang="ja">Tera Term</common-tool> でSSH接続を試みると、接続ができた。
</p><p>
ログイン後 <code>ls -alR</code> コマンドを実行すると、<code>Downloads</code> ディレクトリにファイル <code>flag.txt</code> があることがわかった。<br>
SCPを利用してこのファイルをダウンロードしようとしたが、「the input device is not a TTY」というエラーが出てしまった。<br>
そこで、<code>base64 Downloads/flag.txt</code> コマンドを実行し、得られた出力に<common-tool data-lang="ja">CyberChef</common-tool>で From Base64 をかけることで、ファイルの内容を得た。
</p><p>
このファイルにflagが書かれていた。
</p>
</span>
<span class="language-selector-en">
<p>
A hostname and an username were given, and the way to connect there was in the question.
</p><p>
The last part of the result of applying the <code>strings</code> command to the file <code>pcap-challenge-final.pcapng</code> used in <a href="../../Traffic_Analysis/Monstrum_ex_Machina/" class="language-aware-link">Monstrum ex Machina</a><br>
had a part surrounded by <code>-----BEGIN OPENSSH PRIVATE KEY-----</code> and <code>-----END OPENSSH PRIVATE KEY-----</code>.<br>
Seeing this, I tried to connect via SSH with <common-tool data-lang="en">Tera Term</common-tool> using this part as the private key, and it succeeded.
</p><p>
After logging in, I executed a command <code>ls -alR</code>, finding that there is a file <code>flag.txt</code> in the directory <code>Downloads</code>.<br>
I tried to download this file via SCP, resulting in an error "the input device is not a TTY".<br>
Seeing this, I obtained the contents of the file by executing a command <code>base64 Downloads/flag.txt</code> and applying "From Base64" on <common-tool data-lang="en">CyberChef</common-tool> to the output.
</p><p>
The file contained the flag.
</p>
</span>

<div class="flag">flag{Lucy-a-FUR-G0T-R3KT-by-the-BLUZers-CLUB!!!}</div>
<hr>
<writeup-by></writeup-by>
<p>
<a href="../../" class="language-aware-link">DEADFACE CTF</a>
</p>
</body>
</html>
