<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>EmoEmotet (WaniCTF 2021) Writeup</title>
<script src="../../../../common/common.js"></script>
</head>
<body>
<language-selector data-langlist="日本語,ja,English,en"></language-selector>
<h1>EmoEmotet</h1>
<span class="language-selector-ja" lang="ja">
<p>
ファイル <code>emoemotet.doc</code> が与えられた。
</p><p>
<common-tool data-lang="ja">LibreOffice</common-tool> 7.1.6.2 で開こうとしたところ、破損しているとみなされて開けなかった。<br>
テキストとしてファイルの中身を確認すると、Base64エンコードされているような文字列や、スクリプトのような文字列が見られた。
</p><p>
そこで、問題文にヒントとして示されていたページを参考に、Pythonのvirtualenvを用意して <code>pip install oletools</code> を実行した。<br>
そして、<code>olevba</code> コマンドを用い、ファイルからスクリプトを抽出した。
</p><p>
抽出されたスクリプトを見ると、<code>unxor</code> 関数の呼び出しが並んでいた。<br>
これは、Base64エンコードされた <code>key</code> の指定したオフセット以降のデータと指定した配列のデータをxorする関数であることが読み取れた。<br>
そこで、<common-tool data-lang="ja">CyberChef</common-tool> を用い、まずはここで使っているBase64のデータをデコードした。
</p>
</span>
<span class="language-selector-en" lang="en">
<p>
A file <code>emoemotet.doc</code> was given.
</p><p>
I tried to open the file with <common-tool data-lang="en">LibreOffice</common-tool> 7.1.6.2, but it considered the file as broken and failed to open the file.<br>
Seeing the contents of the file as text, I found strings that looks like Base64-encoded and strings that looks like a part of a script.
</p><p>
Referring the page specified as a hint in the challenge descryption, I set up Python virtualenv and executed a command <code>pip install oletools</code>.<br>
Then, I extracted a script from the file using <code>olevba</code> command.
</p><p>
Reading the extracted script, I found many calls of a function <code>unxor</code>.<br>
This function performs exclusive-or of the input array and Base64-encoded <code>key</code> from the specified offset.<br>
Seeing this, firstly I decoded the Base64 data used here using <common-tool data-lang="ja">CyberChef</common-tool>.
</p>
</span>
<p><a href="https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)To_Hex('None',0)&amp;input=ckZkMTBIM3ZhbzJSQ29keFFGMmxiZmtVQWpJci82REw1cUNueUM0cDVFQTB0RU9YRmFmaGhJZEFJaHVtMFh1bEI5K2xVOXdLUnJEU1daN1hIR3hGblBWVWhxTksyRENuVzhiSTFNVldZeEdoQzRxNWlGVDVFemZDZFRjV1V1MitYOVZUbkt1d2NPYUl4VmNtVnlWanJXSVJ6NERtM2tlY0xOZ0FVOGZaT0tjdS9YdU1YTjg1Wk1LamQzUnY4ODJSQlVGbUlDdmFjZEozNllvams1SEF3WW9CcGpqakh5ZHQ0TndKaXNuWGd0QTNLKzJ4cUdFQmZBUG16NzN1eW43Q3hDS0d0N3hQVWRjK29Sb2VZK29PYml5eklFUFFTM21oV2ZmSHNOQmhrYnJCejFvczN4RWd4dU0zZ042WGE1U0U3Wm82Rzd2TUZlS2RZb3BzM0RHUXV5RFk2MHY3S1hzY09DTHh3cWVSRkMrYnVJUkg2OUU5MEpkUDdLU0M0Q0RaaHhsdi9jblg2SFdkY1doN1VUTTdDV3F6eW10a3FtLzNmanA3NnBHeHNjRzQway9NNlVqYU1uV2crK29Da0paRk1NZW5UdmF4WjdHd3llZGxNeGJPQXRaK0lObEJLK3RQUElGYkc0MlNSdG1KSDFlOFV6NXAxRTdoNjF2ZHhCa2wiICYgXwoibDNzZDE5NnR4aHRuSWxGWnlIQmM1SUtYeEhDYlRhNWhMbDNDQnBFZ2JuMUkyRkZoYUVzWUN0VnlRcmtkUG1BNVg2Q3VGaGp1UmFjVm9NMTMxcE1MVkU3SVFERzcxN0VaNUJkaUxPYzRwYis1UTFpTUFYZlFRNnNvSnJqeE04WmdqelFZTzVXdVFrUUZkZmtvNlFaRWEvMFFhcWh5c09vemovc1Rlb2oyd0kyQTBDL2J3VjM1Y1Y1RVhKTk9hd3FiV0pDWGR3emRzRDhRak5oaURZR1lGaWNKSVJENU1Cc2h2bTFSR3YxQ1p6NTRuK3ppU2dHZTJ2SjZHTXk0Y1d2K2kraHkwL3NoTmd2aFZjS3VKZnVQWnVGVVVIdHFEM3cwN3laS2oybWEraUtZQ3ZJUk85bnU4bFlPUXBiYm93aGExT3lmR3p4N0JKa3ZKeHRoM2IxeG9KYWlOTVJ3UVp6L2ZpQzh6dll4VGxCMGJzSUhLUjA3eGdJOGdmQ0RkK05JaHdMM1liZEFvcjdaZkhoSDNqTmhCVHlrT2x5cmMvMHlMUVNUUjhkeDBCQzlRTUllcmJTQ3FaMVE0clVHRVBpWElWdlhqdHJFaG5TQlRaVzRVNXVKSGZHUWJ6bFZ1dVJSQ1VBanlJekdDREhiRENqdkVnd2JOTExFenFkZUpyaDkiICYgXwoiM0sxV2RkVk80YndjS2xRYjE0bHVXSnpCc0R3ckQ4dTd2aThMVFJJZTZBOTgyRzBPeWdmNitBbTltMkdJa3A2ZVNXWTN0U0YvY09wbXVXYytkMVJDUHpPNWVFQW02VFdUMFVMV1o1UUFNRDMxR09iRXBWUlorZW9DdURTY2tkMEp2clAybEJTYlpLUkFETDB1bnEzdmhubXlUbWZscHZ0SDE1YWhKKzlteGdIR0gyZXhHWDZ2Z0J4MTdpeXg1VDRXdEJvd1FzSVczMTBGMVFySDZ4TmZ2d005UEx2LzNjelNYcy8valVEU0IvQU42MHBWY2N1WnRmUHZwK1pNZzZkOWwwVUtOaVdJcTdDTUtiRTdaN0JXV2pORU1CUGRmR2JOem1RVUx2SFhPWHBubFpleU5kMGh0NTd4OVBsam9GREQ2TitzRXVKMkRScHJnNy9xTlpSSmVrT0FGL1ZJSUQyU1BnRGZDa1JoTGcrWHE1S2d5c0JPNFU1bldLR0QwSU0xVFljYzI0cGJDWTMxYmVVbGViaUtjMmFTN010eFErbzQxd1FhSlE4WXM1aDEzamVOZ3BVejVWemM2QkdXRFVtNitYK0pxdS9OSzFxVXk4Vm1iNXdYVmw2QnFGdDZZN3lFR1d2MzFRS1RpVnd5S1didVYrcFJSWWYzTnZBcVJYNm4iICYgXwoiZDF6Rm1BeXV6b2lWZTFtYXNQa1VVanoyK3VhY3BuOER1VnBLckRKRjY0VUR0NHloRWVCc0xIeWtlY1MrL3IwcHdFQkdKZFAvVmQvWTNPSjRNRlVxbkY5VXZhWWZyRkc3dHJKUWVwbkdIMkRFNFdURm5hNzBocDlGeHg4TGFKTUk4bHhmd0JEeEg1WjU2a2tGK2o0aEx1enE0OHZwUU5JZDR0bityRmZGZUh3cDJHdVpyVk1reVExU1ZTRFc5dVVBald1NlJPaFBFR3d5am5qTTJjRzZNSlFtcGhPRDhiSWZqR25PQXNjZ1UwZDZGTjBCSHpSdHg4NXhad08xVnc9PSI">From Base64, To Hex - CyberChef</a></p>

<span class="language-selector-ja" lang="ja">
<p>
次に、以下の手順により、<code>unxor</code> 関数の処理を再現した。
</p>
<ol>
<li>鍵を1行目に、再現する <code>unxor</code> 関数の呼び出しを2行目以降に入力する。</li>
<li>1行目の鍵をRegisterに入れ、入力から消す。</li>
<li>関数呼び出しの情報からデータとオフセットを取得する。</li>
<li>入力を鍵にし、オフセットを考慮してRegisterに入れる。</li>
<li>入力を関数呼び出しで用いるデータにし、XORを実行する。</li>
</ol>
<p>
以下のRecipeは、<code>CreateObject(</code> と <code>).Run</code> に挟まれている部分のデコードを行う。
</p>
</span>
<span class="language-selector-en" lang="en">
<p>
Then, I simulated what the function <code>unxor</code> does in these steps:
</p>
<ol>
<li>Put the key as the first line and calls of the function <code>unxor</code> to simulate from the second line of the input.</li>
<li>Put the key in the first line to "Register", and remove that from the input.</li>
<li>Obtain the data and offset from the function calls.</li>
<li>Change the input to the key, and put the key to "Register" with caring the offset.</li>
<li>Change the input to the data used in the function call, and apply "XOR".</li>
</ol>
<p>
This Recipe decodes the part between <code>CreateObject(</code> and <code>).Run</code>.
</p>
</span>
<p><a href="https://gchq.github.io/CyberChef/#recipe=Register('(.*)',true,false,false)Tail('Line%20feed',-1)Fork('%5C%5Cn','',false)Register(',%20(%5B0-9%5D%2B)%5C%5C)$',true,false,false)Register('Array%5C%5C((%5B%5E)%5D%2B)%5C%5C)',true,false,false)Find_/_Replace(%7B'option':'Regex','string':'%5E.*$'%7D,'$R0',true,false,false,true)Register('%5E.%7B$R1%7D.%7B$R1%7D(.*)',true,false,false)Find_/_Replace(%7B'option':'Regex','string':'%5E.*$'%7D,'$R2',true,false,true,false)From_Decimal('Comma',false)XOR(%7B'option':'Hex','string':'$R3'%7D,'Standard',false)&amp;input=YWM1Nzc1ZDA3ZGVmNmE4ZDkxMGE4NzcxNDA1ZGE1NmQKdW54b3IoQXJyYXkoMTM1LCA0NiwgMTQwLCAyNCwgMjI4LCAyMjUsIDEyNiwgMTY5LCAzNCwgNDAsIDU2KSwgMykKdW54b3IoQXJyYXkoMjAxLCAxKSwgMTQp">Register, 9 more - CyberChef</a></p>

<span class="language-selector-ja" lang="ja">
<p>
結果は <code>WScript.Shell</code> となった。
</p><p>
行末のゴミを取り除く処理を追加した以下のRecipeは、<code>Run</code> の後の部分のデコードを行う。
</p>
</span>
<span class="language-selector-en" lang="en">
<p>
The result was <code>WScript.Shell</code>.
</p><p>
This Recipe with a step to remove extra things in the end of lines added decoded the part after <code>Run</code>.
</p>
</span>
<p><a href="https://gchq.github.io/CyberChef/#recipe=Register('(.*)',true,false,false)Tail('Line%20feed',-1)Fork('%5C%5Cn','',false)Find_/_Replace(%7B'option':'Simple%20string','string':'%20%26%20_'%7D,'',true,false,true,false)Register(',%20(%5B0-9%5D%2B)%5C%5C)$',true,false,false)Register('Array%5C%5C((%5B%5E)%5D%2B)%5C%5C)',true,false,false)Find_/_Replace(%7B'option':'Regex','string':'%5E.*$'%7D,'$R0',true,false,false,true)Register('%5E.%7B$R1%7D.%7B$R1%7D(.*)',true,false,false)Find_/_Replace(%7B'option':'Regex','string':'%5E.*$'%7D,'$R2',true,false,true,false)From_Decimal('Comma',false)XOR(%7B'option':'Hex','string':'$R3'%7D,'Standard',false)&amp;input=YWM1Nzc1ZDA3ZGVmNmE4ZDkxMGE4NzcxNDA1ZGE1NmRmOTE0MDIzMjJiZmZhMGNiZTZhMGE3YzgyZTI5ZTQ0MDM0YjQ0Mzk3MTVhN2UxODQ4NzQwMjIxYmE2ZDE3YmE1MDdkZmE1NTNkYzBhNDZiMGQyNTk5ZWQ3MWM2YzQ1OWNmNTU0ODZhMzRhZDgzMGE3NWJjNmM4ZDRjNTU2NjMxMWExMGI4YWI5ODg1NGY5MTMzN2MyNzUzNzE2NTJlZGJlNWZkNTUzOWNhYmIwNzBlNjg4YzU1NzI2NTcyNTYzYWQ2MjExY2Y4MGU2ZGU0NzljMmNkODAwNTNjN2Q5MzhhNzJlZmQ3YjhjNWNkZjM5NjRjMmEzNzc3NDZmZjNjZDkxMDU0MTY2MjAyYmRhNzFkMjc3ZTk4YTIzOTM5MWMwYzE4YTAxYTYzOGUzMWYyNzZkZTBkYzA5OGFjOWQ3ODJkMDM3MmJlZGIxYTg2MTAxN2MwM2U2Y2ZiZGVlY2E3ZWMyYzQyMjg2YjdiYzRmNTFkNzNlYTExYTFlNjNlYTBlNmUyY2IzMjA0M2QwNGI3OWExNTlmN2M3YjBkMDYxOTFiYWMxY2Y1YTJjZGYxMTIwYzZlMzM3ODBkZTk3NmI5NDg0ZWQ5YTNhMWJiYmNjMTVlMjlkNjI4YTZjZGMzMTkwYmIyMGQ4ZWI0YmZiMjk3YjFjMzgyMmYxYzJhNzkxMTQyZjliYjg4NDQ3ZWJkMTNkZDA5NzRmZWNhNDgyZTAyMGQ5ODcxOTZmZmRjOWQ3ZTg3NTlkNzE2ODdiNTEzMzNiMDk2YWIzY2E2YjY0YWE2ZmY3N2UzYTdiZWE5MWIxYjFjMWI4ZDI0ZmNjZTk0OGRhMzI3NWEwZmJlYTAyOTA5NjQ1MzBjN2E3NGVmNmIxNjdiMWIwYzllNzY1MzMxNmNlMDJkNjdlMjBkOTQxMmJlYjRmM2M4MTViMWI4ZDkyNDZkOTg5MWY1N2JjNTMzZTY5ZDQ0ZWUxZWI1YmRkYzQxOTI1OTc3YjFkZDdkZWFkYzYxYjY3MjI1MTU5Yzg3MDVjZTQ4Mjk3YzQ3MDliNGRhZTYxMmU1ZGMyMDY5MTIwNmU3ZDQ4ZDg1MTYxNjg0YjE4MGFkNTcyNDJiOTFkM2U2MDM5NWZhMGFlMTYxOGVlNDVhNzE1YTBjZDc3ZDY5MzBiNTQ0ZWM4NDAzMWJiZDdiMTE5ZTQxNzYyMmNlNzM4YTViZmI5NDM1ODhjMDE3N2QwNDNhYjI4MjZiOGYxMzNjNjYwOGYzNDE4M2I5NWFlNDI0NDA1NzVmOTI4ZTkwNjQ0NmJmZDEwNmFhODcyYjBlYTMzOGZmYjEzN2E4OGY2YzA4ZDgwZDAyZmRiYzE1ZGY5NzE1ZTQ0NWM5MzRlNmIwYTliNTg5MDk3NzcwY2RkYjAzZjEwOGNkODYyMGQ4MTk4MTYyNzA5MjExMGY5MzAxYjIxYmU2ZDUxMWFmZDQyNjczZTc4OWZlY2UyNGEwMTllZGFmMjdhMThjY2I4NzE2YmZlOGJlODcyZDNmYjIxMzYwYmUxNTVjMmFlMjVmYjhmNjZlMTU0NTA3YjZhMGY3YzM0ZWYyNjRhOGY2OTlhZmEyMjk4MGFmMjExM2JkOWVlZjI1NjBlNDI5NmRiYTMwODVhZDRlYzlmMWIzYzdiMDQ5OTJmMjcxYjYxZGRiZDcxYTA5NmEyMzRjNDcwNDE5Y2ZmN2UyMGJjY2VmNjMxNGU1MDc0NmVjMjA3MjkxZDNiYzYwMjNjODFmMDgzNzdlMzQ4ODcwMmY3NjFiNzQwYTJiZWQ5N2M3ODQ3ZGUzMzYxMDUzY2E0M2E1Y2FiNzNmZDMyMmQwNDkzNDdjNzcxZDAxMGJkNDBjMjFlYWRiNDgyYTk5ZDUwZTJiNTA2MTBmODk3MjE1YmQ3OGVkYWM0ODY3NDgxNGQ5NWI4NTM5Yjg5MWRmMTkwNmYzOTU1YmFlNDUxMDk0MDIzYzg4Y2M2MDgzMWRiMGMyOGVmMTIwYzFiMzRiMmM0Y2VhNzVlMjZiODdkZGNhZDU2NzVkNTRlZTFiYzFjMmE1NDFiZDc4OTZlNTg5Y2MxYjAzYzJiMGZjYmJiYmUyZjBiNGQxMjFlZTgwZjdjZDg2ZDBlY2EwN2ZhZjgwOWJkOWI2MTg4OTI5ZTllNDk2NjM3YjUyMTdmNzBlYTY2Yjk2NzNlNzc1NDQyM2YzM2I5Nzg0MDI2ZTkzNTkzZDE0MmQ2Njc5NDAwMzAzZGY1MThlNmM0YTU1NDU5ZjllYTAyYjgzNDljOTFkZDA5YmViM2Y2OTQxNDliNjRhNDQwMGNiZDJlOWVhZGVmODY3OWIyNGU2N2U1YTZmYjQ3ZDc5NmExMjdlZjY2YzYwMWM2MWY2N2IxMTk3ZWFmODAxYzc1ZWUyY2IxZTUzZTE2YjQxYTMwNDJjMjE2ZGY1ZDA1ZDUwYWM3ZWIxMzVmYmYwMzNkM2NiYmZmZGRjY2QyNWVjZmZmOGQ0MGQyMDdmMDBkZWI0YTU1NzFjYjk5YjVmM2VmYTdlNjRjODNhNzdkOTc0NTBhMzYyNTg4YWJiMDhjMjliMTNiNjdiMDU2NWEzMzQ0MzAxM2RkN2M2NmNkY2U2NDE0MmVmMWQ3Mzk3YTY3OTU5N2IyMzVkZDIxYjc5ZWYxZjRmOTYzYTA1MGMzZThkZmFjMTJlMjc2MGQxYTZiODNiZmVhMzU5NDQ5N2E0MzgwMTdmNTQ4MjAzZDkyM2UwMGRmMGE0NDYxMmUwZjk3YWI5MmEwY2FjMDRlZTE0ZTY3NThhMTgzZDA4MzM1NGQ4NzFjZGI4YTViMDk4ZGY1NmRlNTI1NzliODhhNzM2NjkyZWNjYjcxNDNlYTM4ZDcwNDFhMjUwZjE4YjM5ODc1ZGUzNzhkODI5NTMzZTU1Y2RjZTgxMTk2MGQ0OWJhZjk3Zjg5YWFlZmNkMmI1YTk0Y2JjNTY2NmY5YzE3NTY1ZTgxYTg1YjdhNjNiYzg0MTk2YmY3ZDUwMjkzODk1YzMyMjk2NmVlNTdlYTUxNDU4N2Y3MzZmMDJhNDU3ZWE3Nzc1Y2M1OTgwY2FlY2U4ODk1N2I1OTlhYjBmOTE0NTIzY2Y2ZmFlNjljYTY3ZjAzYjk1YTRhYWMzMjQ1ZWI4NTAzYjc4Y2ExMTFlMDZjMmM3Y2E0NzljNGJlZmViZDI5YzA0MDQ2MjVkM2ZmNTVkZmQ4ZGNlMjc4MzA1NTJhOWM1ZjU0YmRhNjFmYWM1MWJiYjZiMjUwN2E5OWM2MWY2MGM0ZTE2NGM1OWRhZWY0ODY5ZjQ1YzcxZjBiNjg5MzA4ZjI1YzVmYzAxMGYxMWY5Njc5ZWE0OTA1ZmEzZTIxMmVlY2VhZTNjYmU5NDBkMjFkZTJkOWZlYWM1N2M1Nzg3YzI5ZDg2Yjk5YWQ1MzI0YzkwZDUyNTUyMGQ2ZjZlNTAwOGQ2YmJhNDRlODRmMTA2YzMyOGU3OGNjZDljMWJhMzA5NDI2YTYxMzgzZjFiMjFmOGM2OWNlMDJjNzIwNTM0NzdhMTRkZDAxMWYzNDZkYzdjZTcxNjcwM2I1NTcKdW54b3IoQXJyYXkoMTM3LCAxMjMsIDExNywgODcsIDg5LCAxNDAsIDIwMCwgMTc0LCAxMzgsIDIwNCwgMTM1LCAyMjksIDc1LCA5LCAxNjgsIDM5LCAxMTcsIDIxOSwgMiwgMjEyLCAxMTgsIDIzMCwgMTI4LCAyMTMsIDE5NywgNDQsIDk5LCA5MywgMTkzLCAxNDQsIDQ5LCAyMTAsIDcwLCAxNzUsIDIyOCwgMTYsIDE4NywgNzUsIDM2LCAyMTUsIDE0NCwgMzEsIDIyMywgMTU5LCAxMjcsIDQ1LCA5LCAyMDUsIDE4MywgMzQpLCAxNikgJiBfCnVueG9yKEFycmF5KDE5OSwgMjI4LCAzLCAxNTMsIDgxLCAxOTIsIDI1LCAxMjgsIDEzNywgMTQ3LCAxMzYsIDIzLCA3LCA4MCwgMjI0LCAxMDgsIDIwMywgMjU1LCAxOTcsIDIxLCAxNzQsIDY2LCAxMTcsIDE4NCwgNTIsIDEyNywgNzEsIDE5LCAxODMsIDIzOSwgMjksIDE1NSwgMTgsIDIyMywgMTU5LCAyNDEsIDM1LCAxODMsIDIwMiwgMTc5LCAyMiwgMTAxLCA5OSwgMTAwLCA1NCwgMjE4LCAzMiwgMzMsIDE0MiwgMTk4LCAxNzUsIDE1OSwgMjksIDIwNSwgMTEwLCAxNTQsIDY1LCAyMiwgMjQ3LCAxNTIsIDkxLCAxOTIsIDEwOCwgMTQ1LCA1OCwgMjAzLCAyNSwgMTU4LCA5OSwgMzcsIDEyOCwgMjI5LCA1NCwgNjAsIDM4LCAxNzgsIDEzNCwgMjA4LCA2OCwgMzgsIDM5LCA5OSwgNzYsIDE1NSwgNTYsIDE0NywgNTMsIDE1NiwgMjAzKSwgNjYpICYgXwp1bnhvcihBcnJheSgxMDIsIDE5OCwgMjA4LCAxNjQsIDE4MiwgMjAzLCAxMTcsIDIzMSwgMTI3LCAyMTksIDk0LCAxMjYsIDEwLCAxNjIsIDE3MywgNzIsIDIwNywgMTU2LCAxNTAsIDIxOSwgMTY3LCAxMTcsIDI3LCAxNzIsIDI0MiwgMjMzLCAzMiwgNzIsIDYxLCA2NSwgMTc4LCAxNDIsIDI0NSwgMTMzLCAxMzksIDI5LCAxODEsIDEzNCwgMTgsIDE5OSwgMjQyLCAyMzMsIDE0LCA1LCAxMzQsIDEyNywgMjEyLCA5MSwgOTEsIDgsIDE3MSwgOTAsIDI1LCAxMDksIDE5OCwgOTcsIDYsIDE1NywgMTAsIDQ1LCAyMTQsIDI3LCAxODUsIDEzNCwgMjQ2LCAxNDUsIDMyLCAxOTYsIDIyMSwgMTMxLCAxMzcsIDI3LCAxMDAsIDE0NiwgODAsIDY3LCAxNzcsIDE2MSwgNzEsIDE5MywgMTU1LCAxNzUsIDQyLCAxOTIsIDIyNywgMTcyLCAyMzksIDEyMywgOTIpLCAxNTUpICYgXwp1bnhvcihBcnJheSgyMzQsIDE0MSwgNzksIDE3OSwgMjIzLCAxNSwgMjAzLCA0MywgMTcxLCAxMTIsIDIwMSwgMjM0LCA5OCwgMTQxLCAxNzAsIDE0LCAxNzQsIDEwNCwgNDYsIDEwNywgMTIyLCAxOCwgMTc2LCAxMzgsIDIzOCwgMjA4LCA3OCwgMTI2LCAyMTcsIDIwOCwgMTk3LCAyLCAyMTksIDE0NCwgMTE4LCAxNDUsIDIxMywgNDUsIDE3MywgMjI1LCAyMzMsIDE2MSwgNjYsIDE3NCwgMTk4LCAxMDgsIDQ2LCAxODQsIDI0OSwgMTUwLCAxNzgsIDM2LCAyMjMsIDUsIDQxLCA2MCwgMTA1LCAxMTQsIDExMCwgMTEwLCA0MCwgMTM0LCAxMzksIDM1LCA0MSwgMjM1LCA1NywgMTgyLCA2MCwgMTA1LCA1OCwgMTc1LCAxOTYsIDI0MCwgMjI0LCAxNDQsIDI1MCwgMTU2LCAxNCwgMTM4LCAyMTcsIDksIDE0NywgMTE1LCA1NSwgMTk0LCAxODYsIDE2MiwgNzkpLCAyNDQpICYgXwp1bnhvcihBcnJheSgyMDksIDE5MywgMjAsIDExNCwgMTg5LCAyMzAsIDgsIDE2NywgMjQwLCA2MSwgMjI0LCAyNDIsIDEzNSwgMTY2LCAzOCwgNywgODcsIDE1MSwgMTE3LCAxNDgsIDQ2LCA5NywgMTU4LCAxMTcsIDEwNiwgMTQzLCA0MCwgMTI2LCAxOTksIDI2LCA4MywgMTk2LCAyMTEsIDE2LCAxNTIsIDIwMywgMTIzLCAyMiwgMjQ4LCA2MCwgMTI3LCAzOCwgMTc5LCAxMiwgMTQwLCAxNzAsIDI5LCAxNDgsIDEzMywgNzcsIDgyLCAyMTMsIDUzLCA5MiwgMTQ2LCAxNTEsIDIzNiwgMTUxLCA3NCwgMzcsIDExOCwgMTYsIDI4LCAxNTcsIDQ5LCAxOCwgMTMxLCAxOTUsIDE2NywgMTMzLCA1NCwgMjE0LCAxMiwgMjQ4LCAzMiwgMTA4LCAzNiwgMTMxLCA2NSwgMjUwLCA5NywgMTIsIDI2LCAxMCwgMTgyLCAxNiwgMzQsIDE1LCAxMCksIDMzMykgJiBfCnVueG9yKEFycmF5KDgxLCA3NSwgMTQ4LCAyOCwgMywgMjU0LCA4NCwgMTI3LCA1NywgNzgsIDMwLCAxNDYsIDIzOSwgODIsIDExNSwgMTc1LCAyMCwgMjA4LCA4NywgMjE4LCAxNDAsIDUwLCAxODksIDIxMCwgMTExLCAzNSwgMTIsIDEyOCwgMSwgMTE2LCAyMDgsIDE1MCwgMjMwLCA4OCwgMTY2LCAxMjAsIDM1LCAxMDYsIDE2NiwgMTIxLCAyNDMsIDIxNiwgMjUxLCA0NiwgMjUsIDE5NiwgMTAyLCA1NCwgMTMwLCA1MiwgMjMzLCAxMjMsIDEwMywgMjQwLCAxNDYsIDExNCwgMTQ0LCA0OSwgMjA1LCAxMjEsIDg5LCAxMjYsIDIyNiwgMjM5LCAyMywgNTEsIDcxLCA3LCAxODQsIDExMSwgMTU0LCA3MSwgMzksIDI4LCAxOTEsIDk5LCA0MywgMjM3LCA1OSwgMjQxLCAxODcsIDg0LCAyMDUsIDE2MiwgODIsIDYyLCAyMjcsIDE4MywgMTQ1KSwgNDIyKSAmIF8KdW54b3IoQXJyYXkoMjIwLCAxOTQsIDEzNCwgMTEwLCAxNTgsIDEzNiwgMjgsIDE1NywgNiwgMjgsIDE4LCAyOSwgMjE5LCAxNSwgNDIsIDY5LCAyMDIsIDI2LCAyMTAsIDIxNCwgNDgsIDYwLCAxNTYsIDIxMCwgODgsIDgxLCAxOTEsIDE1MywgMzYsIDcyLCAxOTIsIDIwNSwgNzEsIDEwMSwgMTI1LCA5NiwgODQsIDE3MiwgMTEzLCAxMjAsIDExMiwgMjUyLCAzMSwgMTYsIDkyLCAxODAsIDMsIDQsIDEyNywgNTgsIDIxNCwgMTczLCAxNjUsIDMxLCA2NCwgMjUwLCAxMzksIDE3NiwgNzksIDg5LCAxMzYsIDI0OSwgNDgsIDM3LCAxNTMsIDIwMSwgMTg0LCA1MSwgMTU1LCAxODYsIDk2LCAxMjEsIDc0LCAxNjMsIDI4LCAxMzEsIDIzMCwgNzQsIDE4NiwgMjM3LCAxNywgMTYzLCAxMDEsIDE3LCA1MSwgMSwgNzgsIDQwLCAxMDEpLCA1MTEpICYgXwp1bnhvcihBcnJheSgxNzMsIDk2LCAxMSwgMjAyLCA0NCwgMjE5LCAxNTgsIDY5LCAyMTcsIDU2LCAxNzksIDg0LCAxMTgsIDE1MiwgMTg1LCAxNjMsIDIwLCA5MiwgMywgMjExLCAxNDIsIDIyNiwgOTIsIDI3LCAxNTAsIDE5MSwgMjIyLCA5NSwgMTA1LCA1OCwgODcsIDIwMCwgMTA5LCAxMDgsIDkwLCA0MSwgMTkwLCAyNTIsIDM5LCAyMTUsIDIxNSwgMTUwLCAxMTcsIDE0MCwgMTksIDAsIDIwNiwgMTc0LCA2MCwgODMsIDI1MywgMTM2LCAxNTMsIDExMiwgMjgsIDU1LCA1NCwgMSwgMTMxLCA2NSwgNzQsIDkyLCA5NywgMTM1LCA2NCwgODAsIDE5MiwgMTgxLCAxODMsIDU0LCAxMzAsIDksIDE5NywgNjUsIDE4MiwgMzgsIDE5NiwgMSwgMjQ4LCAyMTcsIDE1NSwgNTAsIDU3LCAxLCAxMzUsIDExNCwgNTMsIDY4LCAxMjYpLCA2MDApICYgXwp1bnhvcihBcnJheSgyNDYsIDEyMywgMjAsIDIwNCwgNTAsIDE1MiwgODUsIDExMSwgMTA2LCAyMTAsIDIsIDI0NywgNDgsIDE1OSwgNjUsIDI1NSwgMzMsIDEzMSwgOTEsIDE1NywgMjQ1LCAyMDQsIDIzMiwgMjIzLCAyMywgMTYzLCAyNDMsIDEwOSwgODEsIDE4MSwgMTk4LCA5OSwgMTMsIDE1MCwgMjAyLCAxNTEsIDEzMywgMjI4LCA1MywgMTkyLCA1MywgMjEyLCAyNTUsIDMwLCAyMTgsIDIyMiwgNzYsIDE3NiwgMjMwLCA0NiwgMTI3LCAwLCAyNTEsIDEzMywgMCwgNzUsIDYsIDk4LCAxNDMsIDIyMSwgMTM1LCA3MCwgODYsIDE1MywgNzIsIDEwNSwgMTY3LCA5MSwgNzcsIDg2LCA2NywgMjQwLCAxNTcsIDE0MywgMjM5LCA0OSwgMTAzLCAyNDcsIDQ0LCAxNTgsIDIzMiwgMjMsIDUwLCAyMjUsIDE1LCAxNzksIDIzNywgOTQsIDEyMCksIDY4OSkgJiBfCnVueG9yKEFycmF5KDIxLCA4MywgMTQyLCAyMDAsIDYwLCA0NywgMjIyLCAxMzMsIDI0MSwgMTIxLCAxMDIsIDc4LCAxMzQsIDIwNCwgMjUyLCAxMTgsIDc0LCA4LCA5NywgOTUsIDEzOCwgOTQsIDYyLCAxNTksIDQ0LCA3NSwgMTQ3LCA3MCwgMTc1LCAxODUsIDc1LCAyMDUsIDIxOCwgMzgsIDI1MSwgMjExLCAxOTksIDIwNywgMTEsIDEyLCAxMTgsIDI0MiwgNzQsIDYyLCAxOSwgMTg3LCAzNiwgMjM5LCAzOCwgMTIwLCA1OCwgMjEsIDE3LCAxMTAsIDExMywgMTkyLCA1NywgNiwgMTExLCAxNjgsIDEwMiwgMjQ0LCAxNDcsIDUzLCAxNTEsIDQ3LCAyNDcsIDY1LCAxMjMsIDc0LCAxODMsIDg3LCAxNjcsIDEzMSwgMjM2LCAyMSwgNjAsIDE2OCwgMTY4LCAxMDksIDI0OSwgMTEzLCAxNjQsIDIwOCwgMTM4LCAxMTAsIDI1MiwgMjE5LCAxODMpLCA3NzgpICYgXwp1bnhvcihBcnJheSgyMjAsIDc3LCAyMTgsIDQxLCAyMjksIDIsIDg4LCAyNTIsIDEwNiwgMjUzLCAyMzYsIDE4NywgMjE1LCA1OSwgMTkzLCAxNSwgMzIsIDE1MCwgMjMxLCAxNTksIDQ4LCAxNDksIDE2MCwgMjI0LCAxMTEsIDE4MiwgMzksIDE0NywgMTE4LCAxMzUsIDEwOSwgMzgsIDI0OSwgMTE4LCA2MywgMjA1LCAyNDcsIDk0LCAzNywgMTc1LCAxMDAsIDIyMiwgMTY0LCAxMDgsIDcxLCAyNDUsIDQyLCAxMTMsIDcsIDE4MSwgODcsIDE4OCwgMjgsIDcxLCAxNzIsIDc1LCAxMjksIDEzNiwgODIsIDgsIDIzOCwgNjUsIDEwNSwgMTI1LCAyNDMsIDE5MCwgMTU2LCAxNjgsIDE4MSwgMjgsIDE1MywgMTkwLCAxOTcsIDI1LCAxNDcsIDg0LCAxMzUsIDc5LCAxODgsIDExLCAxOCwgMzAsIDEzOCwgMTk1LCAyMjgsIDE3NywgMTcyLCAyMzAsIDE2MyksIDg2NykgJiBfCnVueG9yKEFycmF5KDExNiwgMTk0LCAyNDYsIDQ0LCAyMTMsIDYzLCA3NSwgMTI2LCA3OCwgMjAxLCAyMzAsIDI0MSwgMjA1LCAyOCwgMjQwLCAxMjUsIDQ2LCAyNDEsIDUwLCA2MSwgMTEzLCAxMTgsIDExMywgODYsIDE5MCwgNjEsIDQxLCAxNTYsIDE0MCwgODIsIDg1LCAxMDYsIDE1NCwgMTUwLCAxMTYsIDU5LCAzNywgMjUzLCAyMTQsIDI0NSwgMTEyLCAxNTYsIDY4LCAyNDYsIDIyMCwgMTgyLCAxODEsIDE4OSwgNTgsIDIyNSwgOSwgMTY0LCAxNzAsIDIzOCwgMjM3LCA4NiwgMTg3LCA1NSwgOTUsIDEyNSwgNDEsIDI0MCwgMjU0LCAxNzUsIDExMiwgMjEzLCA3LCAxMywgMiwgMjQ2LCA4NiwgMTc2LCAyOSwgOTcsIDEwNSwgMjI5LCAxMjcsIDEyMSwgMTU4LCA3NywgNTEsIDMyLCAxMTYsIDEwNCwgMjEzLCAxNTgsIDIxMSwgMjMxLCAxNjEpLCA5NTYpICYgXwp1bnhvcihBcnJheSgxMjksIDQzLCAxMzQsIDEyLCA4LCAyNSwgMjI4LCAyMTAsIDE0NSwgMjMwLCAxMDAsIDE1LCAxOTcsIDkzLCAxNTcsIDIwNywgMjYsIDg5LCAyMjAsIDE4MCwgODQsIDE2NCwgMTAyLCAyNiwgMjQ5LCAxOTMsIDM0LCAzOSwgMjI1LCAxNzMsIDEzNiwgNDgsIDIsIDE4OSwgNzksIDE0OSwgMTI2LCA5MSwgOTksIDEwMCwgODksIDIzMCwgMjM5LCA1NSwgMjM4LCAxMTgsIDIwMCwgMjE1LCAyMTIsIDEwMywgMTgwLCAyOSwgMTY5LCAxNjksIDg2LCAyNTMsIDc2LCA0MywgMjA1LCAxODQsIDEwLCAyMDAsIDIzOSwgMTYyLCAxNDAsIDEyNywgNDUsIDIxNCwgMTMzLCAxMzIsIDMyLCA0NiwgMjIxLCA2NiwgNDksIDI4LCAyMzcsIDIzMywgMjksIDU1LCAzNCwgMjMzLCAyNDMsIDkxLCAyNywgMTgyLCAxNDYsIDU4LCAyMTApLCAxMDQ1KSAmIF8KdW54b3IoQXJyYXkoMjIxLCA1OSwgMTE1LCA5MiwgMzksIDE2OSwgMjYsIDE3MSwgNSwgNTAsIDE5NywgMTMxLCAxMTksIDE4NCwgMTA3LCA0LCAyOSwgMTkyLCA1MywgNDgsIDEzMiwgMjA4LCA2NSwgMjM5LCAxNTUsIDI1NSwgMjE1LCAxMSwgMjQsIDIyMywgMTM2LCAxODQsIDY0LCA1MywgMTI2LCAxMzAsIDE4NywgMTYzLCAxNjQsIDIzMSwgMzcsIDY2LCAyNTEsIDI4LCAxMSwgMjM0LCAyLCA0LCAxNjQsIDIyNiwgNjYsIDEyOSwgMjA1LCAyMjgsIDY0LCAxNjEsIDU0LCAxMjUsIDYyLCAyMjQsIDU2LCAxMzEsIDEzNCwgMTkxLCAyMjMsIDEyMCwgMTMwLCAxNywgNywgMTA5LCAxNTQsIDE5MCwgNywgMTQyLCAxNTQsIDEzNiwgMTYzLCA2MiwgMTI1LCAyMCwgOTcsIDIwNSwgMzAsIDUxLCAyNTIsIDIyOSwgMTE2LCAyMzcsIDI5KSwgMTEzNCkgJiBfCnVueG9yKEFycmF5KDI1MCwgMjQ0LCAyMDgsIDE3LCA1MCwgMjEyLCAxMzUsIDEyMiwgNDksIDEzNCwgMTU1LCAzNywgMTMxLCAyMDQsIDIzOSwgMTY2LCAyMTUsIDIyMSwgNDksIDEzNCwgOTIsIDYzLCA0MSwgMTk3LCA3MywgMTc2LCAyNiwgMzAsIDEzNCwgMTE5LCAxNzYsIDEyMywgMjE1LCA1NiwgMTU5LCA4LCA2NiwgMTc1LCAxMjcsIDY3LCA3MywgMTc0LCAxMjgsIDE2MiwgMTQyLCAyMDksIDEsIDEzNiwgOTIsIDE2MCwgMTQ3LCAxOTEsIDIzMywgOTksIDEzMiwgNDIsIDExLCAxMDcsIDE4OCwgNDIsIDIyMSwgMTk0LCAxOCwgMTA3LCAxNzQsIDc5LCAxNiwgMjAsIDEwNCwgMTU1LCAxODMsIDE4OCwgMTE5LCAyMDcsIDI3LCAyNTEsIDEsIDEzMSwgMTQsIDkxLCA2MSwgMTE1LCAyMzMsIDU3LCAxNDMsIDE3OCwgMTI4LCAyNDYsIDg3KSwgMTIyMykgJiBfCnVueG9yKEFycmF5KDIxNCwgOTUsIDIzMSwgODQsIDIxNCwgMTc2LCAyMzUsIDc4LCAyMDYsIDQ0LCAxNDMsIDY4LCAxNTAsIDk3LCA0OSwgNDgsIDU2LCA4MiwgMTU2LCA2OCwgNDMsIDExNywgNjMsIDEzNCwgMTQzLCAzMCwgMzgsIDY0LCAyMjIsIDIyKSwgMTMxMik">Register, 10 more - CyberChef</a></p>

<p class="language-selector-ja" lang="ja">
得られた結果にはBase64エンコードされているっぽい部分があったので、デコードを行った。<br>
その結果は文字と <code>.</code> が交互になっていたので、UTF-16であると推測した。
</p>
<p class="language-selector-en" lang="en">
The result had a part that looks like Base64-encoded, so I decoded that.<br>
The result had <code>.</code> between each characters, so I guessed that the result is UTF-16.
</p>
<p><a href="https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)Decode_text('UTF-16LE%20(1200)')&amp;input=TGdBb0FDY0FhUUJsQUZnQUp3QXBBQ2dBYmdCRkFIY0FMUUJ2QUdJQWFnQkZBR01BZEFBZ0FGTUFXUUJ6QUhRQVpRQk5BQzRBU1FCdkFDNEFVd0IwQUZJQVpRQkJBRTBBY2dCbEFHRUFaQUJGQUhJQUtBQWdBQ2dBSUFCdUFFVUFkd0F0QUc4QVlnQnFBRVVBWXdCMEFDQUFJQUJUQUhrQWN3QjBBRVVBVFFBdUFFa0FUd0F1QUVNQVR3Qk5BRkFBVWdCRkFITUFjd0JwQUU4QVRnQXVBR1FBWlFCbUFHd0FZUUJVQUVVQVV3QjBBSElBWlFCaEFFMEFLQUJiQUVrQWJ3QXVBRTBBWlFCdEFHOEFVZ0I1QUhNQVZBQlNBRVVBUVFCTkFGMEFJQUJiQUhNQVdRQnpBRlFBWlFCTkFDNEFZd0JQQUc0QWRnQkZBSElBVkFCZEFEb0FPZ0JtQUZJQVR3Qk5BRUlBUVFCVEFFVUFOZ0EwQUZNQVZBQnlBR2tBYmdCbkFDZ0FJQUFuQUdJQVl3QTJBRGtBUXdCekFFa0Fkd0JIQUVrQVdBQm9BRkFBVmdCbUFIZ0FSd0JTQUhjQVZRQk1BRXdBVXdCckFHc0Fjd0JzQUVJQVFnQllBRGtBUVFCVkFFSUFkd0JWQUhBQU9RQkJBRzBBYmdBM0FGRUFVUUJ0QURVQWNRQnJBRklBY0FCSUFHVUFkUUI1QURBQU5nQlBBSEFBT0FCSUFIb0Fid0IxQUhrQVRRQkZBRUVBZGdBMkFFTUFXUUJSQUVVQVRBQlNBRFVBU1FCS0FIY0FWd0E0QUhjQVJRQnNBRm9BUmdCb0FGY0FaQUJsQUU0QWFBQkNBR3NBWmdCTkFGWUFUQUJSQUhnQWVnQm5BRTBBT1FCYUFFMEFOQUJHQUZrQU1RQlZBRE1BYkFBeEFHTUFXUUF2QUZVQWFRQkZBR1FBTmdCREFISUFNd0JZQUhvQU9RQkVBRzRBUlFCUkFIWUFSd0JEQUVNQU13QllBRXNBYlFCR0FFWUFVQUJwQUdzQVlRQmpBR2tBY1FCVkFGTUFTUUJ5QUZJQVNnQndBSGNBS3dCT0FHSUFlUUJvQUU4QVdnQmhBSFlBTUFCVEFEY0FUUUJzQUdzQWR3QjZBSFlBVXdBckFIb0Fid0JQQUhvQVJRQTBBRXdBY0FCeUFGY0FXUUJUQUhBQWRnQlZBSFlBU3dCV0FHb0FaUUJDQUU4QVFRQnpBSGtBTUFBNUFGSUFkZ0IyQUVjQU9RQjZBRGtBTUFCaEFHRUFlQUJHQURZQVlnQjFBRFlBUmdCc0FFRUFOd0F2QUVVQVR3QXlBR3dBWmdCNUFHa0FlZ0JvQUVRQWVRQkJBRkVBUFFBOUFDY0FLUUFzQUNBQVd3QnpBRmtBVXdCMEFFVUFUUUF1QUdrQWJ3QXVBRU1BVHdCTkFGQUFVZ0JsQUZNQVV3QnBBRzhBVGdBdUFHTUFUd0J0QUhBQWNnQmxBSE1BVXdCcEFFOEFUZ0J0QUU4QVpBQkZBRjBBT2dBNkFFUUFaUUJEQUc4QWJRQlFBSElBUlFCVEFGTUFLUUFnQUNrQUxBQmJBSE1BZVFCekFGUUFSUUJ0QUM0QVZBQkZBRmdBZEFBdUFHVUFiZ0JqQUU4QVpBQkpBRTRBUndCZEFEb0FPZ0JCQUhNQVl3QnBBRWtBS1FBZ0FDa0FMZ0J5QUdVQVlRQkVBRlFBYndCRkFFNEFSQUFvQUNrQQ">From Base64, Decode text - CyberChef</a></p>

<p class="language-selector-ja" lang="ja">
結果はBase64エンコードされた文字列をデコードして解凍しているようだったので、同様の処理を行った。
</p>
<p class="language-selector-en" lang="en">
The result looked like decoding a Base64-encoded string and expanding that, so I followed the process.
</p>
<p><a href="https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)Raw_Inflate(0,0,'Adaptive',false,false)&amp;input=YmM2OUNzSXdHSVhoUFZmeEdSd1VMTFNra3NsQkJYOUFVQndVcDlBbW43UVFtNXFrUnBIZXV5MDZPcDhIem91eU1FQXY2Q1lRRUxSNUlKd1c4d0VsWkZoV2RlTmhCa2ZNVkxReHpnTTlaTTRGWTFVM2wxY1kvVWlFZDZDcjNYejlEbkVRdkdDQzNYS21GRlBpa2FjaXFVU0lyUkpwdytOYnloT1phdjBTN01sa3d6dlMrem9PekU0THByV1lTcHZVdktWamVCT0FzeTA5UnZ2Rzl6OTBhYXhGNmJ1NkZsQTcvRU8ybGZ5aXpoRHlBUT09">From Base64, Raw Inflate - CyberChef</a></p>

<p class="language-selector-ja" lang="ja">
この結果にflagが含まれていた。
</p>
<p class="language-selector-en" lang="en">
The result contained the flag.
</p>

<div class="flag">FLAG{w0w_7h3_3mb3dd3d_vb4_1n_w0rd_4u70m471c4lly_3x3cu73d_7h3_p0w3r5h3ll_5cr1p7}</div>
<hr>
<writeup-by></writeup-by>
<p>
<a href="../../" class="language-aware-link">WaniCTF 2021</a>
</p>
</body>
</html>
