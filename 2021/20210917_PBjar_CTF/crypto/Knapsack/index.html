<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Knapsack (PBjar CTF) Writeup</title>
<script src="../../../../common/common.js"></script>
</head>
<body>
<language-selector data-langlist="日本語,ja,English,en"></language-selector>
<h1>Knapsack</h1>
<span class="language-selector-ja">
<p>
プログラム <code>knapsack.py</code> とその出力 <code>output.txt</code> が与えられた。<br>
<code>output.txt</code> の内容は、整数のリスト<code>b</code> と整数 <code>c</code> だった。
</p><p>
「knapsack cipher writeup」でググると、以下のページが見つかった。
</p>
</span>
<span class="language-selector-en">
<p>
A program <code>knapsack.py</code> and its output <code>output.txt</code> were given.<br>
The contents of <code>output.txt</code> was a list of integers <code>b</code> and an integer <code>c</code>.
</p><p>
I googled "knapsack cipher writeup" and found this page:
</p>
</span>
<p><a href="https://kimiyuki.net/writeups/ctf-2015-plaidctf-2015-lazy/">PlaidCTF CTF 2015: Lazy - うさぎ小屋</a></p>

<p class="language-selector-ja">
このページのimplementationの部分に書かれているコードを<common-tool data-lang="ja">Sage Cell Server</common-tool>にコピペし、
<code>b</code>と<code>c</code>をファイルから読む部分を<code>output.txt</code>の内容を直接代入するコードに置き換えた。<br>
さらに、<code>print</code>の行に<code>()</code>を補って実行すると、以下の結果(抜粋)が得られた。
</p>
<p class="language-selector-en">
I copy-and-pasted the code in the "implementation" part of the page to <common-tool data-lang="en">Sage Cell Server</common-tool>
and replaced the part to read <code>b</code> and <code>c</code> from a file to a code to directly assign the contents of <code>output.txt</code>.<br>
I also added <code>()</code> to the line with <code>print</code> and executed the code. The (excerpt of) result was:
</p>
<code-block data-extension="txt">
[*] plaintext: m = 153155963663290041054197307311943027493489207784270037292096307
</code-block>

<p class="language-selector-ja">
この数値を<common-tool data-lang="ja">CyberChef</common-tool>に入れて観察した結果、
バイナリに変換するとflagのfのビット列の一部<code>110011</code>が最後の方に現れることを発見した。<br>
そこで、ビット列をひっくり返して先頭に<code>0</code>を追加し、文字列に変換すると、flagが得られた。
</p>
<p class="language-selector-en">
I put this number to <common-tool data-lang="en">CyberChef</common-tool> and observed.
As a result, I found a part of the bit puttern <code>110011</code> for "f" in "flag" appearing in the last part when I convert the number to binary.<br>
I obtained the flag by reversing the bit sequence, adding <code>0</code> to the head, and converting to a string.
</p>
<p><a href="https://gchq.github.io/CyberChef/#recipe=To_Base(16)From_Hex('Auto')To_Binary('Space',8)Reverse('Character')Pad_lines('Start',1,'0')From_Binary('Space',8)&input=MTUzMTU1OTYzNjYzMjkwMDQxMDU0MTk3MzA3MzExOTQzMDI3NDkzNDg5MjA3Nzg0MjcwMDM3MjkyMDk2MzA3"
>To Base, 5 more - CyberChef</a></p>

<div class="flag">flag{b4d_r_4nd_q_1s_sc4ry}</div>
<hr>
<p>
<a href="../../" class="language-aware-link">PBjar CTF</a>
</p>
</body>
</html>
