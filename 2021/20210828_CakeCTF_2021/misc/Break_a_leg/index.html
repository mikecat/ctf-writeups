<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Break a leg (CakeCTF 2021) Writeup</title>
<script src="../../../../common/common.js"></script>
</head>
<body>
<language-selector data-langlist="日本語,ja,English,en"></language-selector>
<h1>Break a leg</h1>
<span class="language-selector-ja">
<p>
画像ファイル <code>chall.png</code> と、それを作ったと考えられるプログラム <code>chall.py</code> が与えられた。
</p><p>
<code>chall.py</code> を読むと、画像はランダムな値のLSBにflagの各ビットを順にORして作っていることが読み取れた。<br>
ということは、flagのあるビットが0ならば対応する値のLSBは0のことも1のこともあるが、flagのあるビットが1ならば対応する値のLSBは必ず1になるはずである。
</p><p>
そこで、まず <code>chall.png</code> を<common-tool data-lang="ja">CyberChef</common-tool>の Extract RGBA (Delimiter は空白、Include Alpha はオフ) で数字列に変換した。<br>
そして、以下のプログラムで、flagのビット数の仮定を変えながら復元を行った。
</p>
</span>
<span class="language-selector-en">
<p>
An image file <code>chall.png</code> and a program that should generated the image <code>chall.py</code> were given.
</p><p>
Reading <code>chall.py</code>, I found that the image was generated by applying bitwise OR with each bits of the flag to random values.<br>
This means that the LSB of corresponding value can be eithor 0 or 1 when a bit of the flag is 0, but the LSB must be 1 when a bit of the flag is 1.
</p><p>
Based on this, firstly I converted <code>chall.png</code> to a sequence of integers vla "Extract RGBA" (Delimiter: space, Include Alpha: off) on <common-tool data-lang="en">CyberChef</common-tool>.<br>
Then, I recoverted the data via this program with changing the assumution of how many bits are in the flag:
</p>
</span>
<p><a href="solve.pl" class="code-link" data-collapse="true">solve.pl</a></p>

<p class="language-selector-ja">
出力の中にあった文字列を反転させ、先頭に <code>C</code> を補うことで、flagが得られた。
</p>
<p class="language-selector-en">
I obtained the flag by reversing the string in the output and adding <code>C</code> to the head of the string.
</p>

<div class="flag">CakeCTF{1_w1sh_y0u_can_h1t_the_gr0und_runn1ng_fr0m_here;)}</div>
<hr>
<writeup-by></writeup-by>
<p>
<a href="../../" class="language-aware-link">CakeCTF 2021</a>
</p>
</body>
</html>
