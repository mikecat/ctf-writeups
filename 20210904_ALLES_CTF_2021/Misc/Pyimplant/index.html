<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Pyimplant (ALLES! CTF 2021) Writeup</title>
<script src="../../../common/common.js"></script>
</head>
<body>
<language-selector data-langlist="日本語,ja,English,en"></language-selector>
<h1>Pyimplant</h1>
<span class="language-selector-ja">
<p>
ファイル <code>manipulated_tictactoe.cpython-36.pyc</code> と、Pythonのソースコード <code>tictactoe.py</code> が与えられた。
</p><p>
<code>manipulated_tictactoe.cpython-36.pyc</code> をバイナリエディタで開き、<code>!</code> を検索すると、
flagの最初の<code>ALLES!{</code>が数バイトおきに入っている部分が見つかった。<br>
また、その少し後にflagの最後の<code>}</code>も見つかった。
</p><p>
そこで、ファイル <code>manipulated_tictactoe.cpython-36.pyc</code> のファイル名に<code>36</code>と入っていることから、
以下のサイトでPython3.6を用意した。
</p>
</span>
<span class="language-selector-en">
<p>
A file <code>manipulated_tictactoe.cpython-36.pyc</code> and a Python source code <code>tictactoe.py</code> were given.
</p><p>
I opened <code>manipulated_tictactoe.cpython-36.pyc</code> with a binary editor and searched for <code>!</code>.<br>
As a result, I found a part that contains the prefix of the flag <code>ALLES!{</code> with a few other bytes between each of them.<br>
Also I found the suffix of the flag <code>}</code> near the part.
</p><p>
Seeing this, I prepared Python3.6 from this page because the file name of <code>manipulated_tictactoe.cpython-36.pyc</code> contains <code>36</code>.
</p>
</span>
<p><a href="https://www.python.org/downloads/release/python-368/">Python Release Python 3.6.8 | Python.org</a></p>

<p class="language-selector-ja">
このPython3.6を用い、
</p>
<p class="language-selector-en">
Using this Python3.6, I used this command to compile <code>tictactoe.py</code>:
</p>
<code-block data-extension="txt">
(path)\python -m compileall tictactoe.py
</code-block>
<p class="language-selector-ja">
というコマンドで <code>tictactoe.py</code> のコンパイルを行った。<br>
さらに、その結果を以下のプログラムで <code>manipulated_tictactoe.cpython-36.pyc</code> と比較し、違っているバイトを抽出した。
</p>
<p class="language-selector-en">
After that, I compared the compilation result with <code>manipulated_tictactoe.cpython-36.pyc</code> and extracted bytes that differ.
</p>
<p><a href="file_diff.pl" class="code-link" data-collapse="true">file_diff.pl</a></p>

<p class="language-selector-ja">
抽出結果にflagが含まれていた。
</p>
<p class="language-selector-en">
The extracted data contained the flag.
</p>

<div class="flag">ALLES!{py7h0n_byt3cod3_s3cr3ts}</div>
<hr>
<p>
<a href="../../" class="language-aware-link">ALLES! CTF 2021</a>
</p>
</body>
</html>
